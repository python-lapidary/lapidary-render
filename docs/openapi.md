# OpenAPI

OpenAPI compatibility

- âœ… `openapi`: validated (3.0.* accepted)
- `info`
    - âŒ `license`: N/A; it's up to the user to verify the accepted use.
    - ğŸ—“ï¸ `title` and other fields: planned as part of project readme
- ğŸ—“ï¸ `externalDocs`: planned as part of the project readme
- âœ… `servers`: first server is used
    - âœ… `url`: used as the base URL
    - âœ… `variables`: default values are used to evaluate the server URL
- âœ… `security`: implemented
- âŒ `tags`: ignored
- `components`
    - âœ… `schemas`:
        - ğŸ—“ï¸ `title`: planned as part of class docstr
        - `type`
            - ğŸ—“ï¸ [no value]: planned as primitive JSON-compatible object.
            - âœ… `object`: implemented as pydantic models
            - âœ… `array`: implemented as list
            - âœ… `string`, `integer`, `number`, `boolean`: implemented as `str`, `int`, `float` and `bool`
        - ğŸ—“ï¸ `format`: planned, including custom formats
        - âœ… assertion keywords: as supported by pydantic
        - âš ï¸ `allOf`: needs improvement
        - âœ… `anyOf`: implemented as union
        - âš ï¸ `oneOf`: treated as `anyOf` and implemented as `Union`
        - ğŸ—“ï¸ `not`: planned for objects
        - âœ… `required`: non-required properties are turned to `Union[None, $type]`
        - `additionalProperties`:
            - âœ… boolean: supported as pydantic `extra: 'allow'` or `'forbid'`
            - ğŸ—“ï¸ schema: planned as a `Mapping` field
        - ğŸ—“ï¸ `patternProperties`: planned as `Mapping` field
        - ğŸ” `enum`: ignored; might be implemented for simple types as `Literal`
        - ğŸ“„ `description`: planned as part of docstr
        - âœ… `default`: if present, the property type turned to `Union[None, $type]` and has default value `None`
            - ğŸ” caveat: default values are not to be sent between Web API client and server, instead they are implied by the receiving side. Lapidary could potentially implement generating default values for some cases but they don't necessary need to validate against the schema.
        - âœ… `nullable`: if true, the property type is turned to `Union[None, $type]`
        - âœ… `readOnly` & `writeOnly`: if either is true, the property type is turned to `Union[None, $type]` and has default value `None`; planned as part of docstr
            - âš ï¸ caveat: readOnly properties are only to be sent to API server, and writeOnly only to be received by the client. A property might be both required one way, and invalid the other way, which could not be directly represented in Python, except with two or three classes for every schema.
        - âŒ `discriminator`: ignored
        - ğŸ” `example`: might be used as part of docstr
        - ğŸ—“ï¸ `externalDocs`: planned as part of docstr
        - ğŸ—“ï¸ `deprecated`: planned
        - âŒ `xml`: ignored, currently not planned
    - `responses`
        - ğŸ—“ï¸ `description`: planned as part of docstr
        - âœ… `headers`: if present, used as fields in the response envelope class
        - âœ… `content`: implemented; used as operation method return type, and a way to resolve model type for a response
        - ğŸ” `links`: ignored; might be used to generate methods in the response envelope
    - âœ… `parameters`: used in-line in operations
    - ğŸ” `examples`: currently ignored
    - `requestBodies`
        - ğŸ—“ï¸ `description`: planned as part of docstr
        - âœ… `content`: implemented
        - ğŸ—“ï¸ `required`: planned
    - âœ… `headers`: implemented
    - âš ï¸ `securitySchemes`: implemented with httpx_auth
        - âŒ `refreshUrl`: not supported
    - ğŸ—“ï¸ `links`: planned
    - âŒ `callbacks`: not planned
- `paths`: ğŸ—“ï¸ planned as keys in a TypedDict
    - operations: âœ… mapped to operation methods
        - `operationId`: âœ… used as method name
        - ğŸ—“ï¸ `summary`, `description`: planned as parts of docstr
        - âŒ `servers`: ignored
        - `parameters`
            - âœ… `name`: OpenAPI parameter names are not unique and might contain characters invalid for python names, therefore they're escaped and suffix-hungarian notation is used to distinguish between cookie, header, path and query parameters
            - âœ… `in`: implemented, suffix-hungarian notation is used to separate parameters
            - âœ… `required`: non-required parameters are optional with default value `None`
            - ğŸ—“ï¸ `deprecated`: planned
            - ğŸ—“ï¸ `allowEmptyValue`: planned
            - ğŸ—“ï¸ `content`: key: planned, value: processed as schema
            - âš ï¸ `style`: partially implemented
            - ğŸ—“ï¸ `allowReserved`: planned
            - âœ… `schema`: implemented
            - ğŸ” `example` & examples: considered
            - ğŸ”§ `x-lapidary-name`: name of a parameter in the python
- ğŸ”§ `x-lapidary-responses-global`: responses that might come from any operation
- ğŸ”§ `x-lapidary-headers-global`: headers accepted by any operation
